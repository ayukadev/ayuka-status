<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ayuka ‚Äî Statut</title>
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet"/>
  <style>
    :root {
      --bg: #0a0a12;
      --surface: #12121e;
      --surface2: #1a1a2e;
      --border: rgba(114, 97, 218, 0.18);
      --purple: #7261da;
      --purple-light: #9b8ef0;
      --purple-glow: rgba(114, 97, 218, 0.3);
      --green: #4ade80;
      --green-glow: rgba(74, 222, 128, 0.25);
      --red: #f87171;
      --red-glow: rgba(248, 113, 113, 0.25);
      --yellow: #fbbf24;
      --yellow-glow: rgba(251, 191, 36, 0.25);
      --text: #e8e6f0;
      --muted: #6b6880;
      --mono: 'DM Mono', monospace;
      --sans: 'Syne', sans-serif;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: var(--sans);
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background:
        radial-gradient(ellipse 80% 60% at 20% 10%, rgba(114,97,218,0.12) 0%, transparent 60%),
        radial-gradient(ellipse 60% 50% at 80% 80%, rgba(91,72,196,0.08) 0%, transparent 55%),
        radial-gradient(ellipse 40% 40% at 50% 50%, rgba(114,97,218,0.04) 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
    }

    body::after {
      content: '';
      position: fixed;
      inset: 0;
      background-image:
        linear-gradient(rgba(114,97,218,0.04) 1px, transparent 1px),
        linear-gradient(90deg, rgba(114,97,218,0.04) 1px, transparent 1px);
      background-size: 40px 40px;
      pointer-events: none;
      z-index: 0;
    }

    /* Banni√®re maintenance */
    .maintenance-banner {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0;
      background: linear-gradient(90deg, rgba(251,191,36,0.15), rgba(251,191,36,0.08));
      border-bottom: 1px solid rgba(251,191,36,0.3);
      padding: 12px 24px;
      z-index: 100;
      text-align: center;
      font-family: var(--mono);
      font-size: 0.78rem;
      color: var(--yellow);
      backdrop-filter: blur(10px);
    }

    .maintenance-banner.visible { display: block; }

    .container {
      max-width: 760px;
      margin: 0 auto;
      padding: 60px 24px 100px;
      position: relative;
      z-index: 1;
    }

    .container.with-banner { padding-top: 110px; }

    header {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 56px;
      animation: fadeDown 0.7s ease both;
    }

    .bot-avatar {
      width: 64px; height: 64px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--purple), #4b3fa0);
      display: flex; align-items: center; justify-content: center;
      font-size: 28px;
      box-shadow: 0 0 30px var(--purple-glow), 0 0 60px rgba(114,97,218,0.1);
      flex-shrink: 0; position: relative;
    }

    .bot-avatar::after {
      content: ''; position: absolute; inset: -2px; border-radius: 50%;
      background: linear-gradient(135deg, var(--purple-light), transparent, var(--purple));
      z-index: -1; opacity: 0.6;
    }

    .header-text h1 {
      font-size: 2rem; font-weight: 800; letter-spacing: -0.5px;
      background: linear-gradient(135deg, #fff 30%, var(--purple-light));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      background-clip: text; line-height: 1.1;
    }

    .header-text p {
      font-family: var(--mono); font-size: 0.75rem; color: var(--muted);
      margin-top: 4px; letter-spacing: 0.05em;
    }

    .global-status {
      display: flex; align-items: center; gap: 16px;
      background: var(--surface); border: 1px solid var(--border);
      border-radius: 16px; padding: 20px 28px; margin-bottom: 32px;
      animation: fadeDown 0.7s 0.1s ease both;
      position: relative; overflow: hidden; transition: border-color 0.3s;
    }

    .global-status::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px;
      background: linear-gradient(90deg, transparent, var(--purple), transparent);
      opacity: 0.5;
    }

    .global-status.maintenance { border-color: rgba(251,191,36,0.3); }
    .global-status.maintenance::before {
      background: linear-gradient(90deg, transparent, var(--yellow), transparent);
    }

    .status-dot {
      width: 14px; height: 14px; border-radius: 50%;
      flex-shrink: 0; position: relative;
    }

    .status-dot.online { background: var(--green); box-shadow: 0 0 12px var(--green-glow); }
    .status-dot.online::after {
      content: ''; position: absolute; inset: -4px; border-radius: 50%;
      background: var(--green); opacity: 0.2; animation: pulse 2s ease infinite;
    }
    .status-dot.offline { background: var(--red); box-shadow: 0 0 12px var(--red-glow); }
    .status-dot.unknown { background: var(--muted); }
    .status-badge.unknown { background: rgba(107,104,128,0.12); color: var(--muted); border: 1px solid rgba(107,104,128,0.25); }
    .status-dot.maintenance { background: var(--yellow); box-shadow: 0 0 12px var(--yellow-glow); }
    .status-dot.maintenance::after {
      content: ''; position: absolute; inset: -4px; border-radius: 50%;
      background: var(--yellow); opacity: 0.2; animation: pulse 2s ease infinite;
    }

    .status-label { flex: 1; }
    .status-label strong { display: block; font-size: 1rem; font-weight: 700; color: var(--text); }
    .status-label span { font-family: var(--mono); font-size: 0.72rem; color: var(--muted); }

    .status-badge {
      font-family: var(--mono); font-size: 0.7rem; font-weight: 500;
      padding: 6px 14px; border-radius: 999px;
      letter-spacing: 0.08em; text-transform: uppercase;
    }

    .status-badge.online { background: rgba(74,222,128,0.12); color: var(--green); border: 1px solid rgba(74,222,128,0.25); }
    .status-badge.offline { background: rgba(248,113,113,0.12); color: var(--red); border: 1px solid rgba(248,113,113,0.25); }
    .status-badge.maintenance { background: rgba(251,191,36,0.12); color: var(--yellow); border: 1px solid rgba(251,191,36,0.25); }

    .metrics-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 32px; }
    @media (max-width: 560px) { .metrics-grid { grid-template-columns: 1fr; } }

    .metric-card {
      background: var(--surface); border: 1px solid var(--border);
      border-radius: 14px; padding: 22px 20px;
      position: relative; overflow: hidden;
      transition: border-color 0.3s, transform 0.3s;
      animation: fadeUp 0.6s ease both;
    }

    .metric-card:hover { border-color: rgba(114,97,218,0.4); transform: translateY(-2px); }
    .metric-card::after {
      content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 2px;
      background: linear-gradient(90deg, transparent, var(--purple), transparent);
      opacity: 0; transition: opacity 0.3s;
    }
    .metric-card:hover::after { opacity: 1; }
    .metric-card:nth-child(1) { animation-delay: 0.15s; }
    .metric-card:nth-child(2) { animation-delay: 0.22s; }
    .metric-card:nth-child(3) { animation-delay: 0.29s; }

    .metric-icon { font-size: 1.3rem; margin-bottom: 12px; display: block; }
    .metric-label { font-family: var(--mono); font-size: 0.68rem; color: var(--muted); letter-spacing: 0.1em; text-transform: uppercase; margin-bottom: 6px; }
    .metric-value { font-size: 1.6rem; font-weight: 800; color: var(--text); line-height: 1; letter-spacing: -0.5px; }
    .metric-sub { font-family: var(--mono); font-size: 0.68rem; color: var(--muted); margin-top: 4px; }

    .section-title { font-family: var(--mono); font-size: 0.7rem; color: var(--muted); letter-spacing: 0.12em; text-transform: uppercase; margin-bottom: 14px; animation: fadeUp 0.6s 0.35s ease both; }

    .uptime-bar { display: flex; gap: 3px; align-items: flex-end; height: 48px; margin-bottom: 32px; animation: fadeUp 0.6s 0.4s ease both; }
    .uptime-bar-segment { flex: 1; border-radius: 3px; transition: transform 0.2s; cursor: default; }
    .uptime-bar-segment:hover { transform: scaleY(1.15); }
    .uptime-bar-segment.up { background: linear-gradient(to top, #2d6a46, var(--green)); height: 100%; }
    .uptime-bar-segment.down { background: linear-gradient(to top, #6a2d2d, var(--red)); height: 40%; }
    .uptime-bar-segment.partial { background: linear-gradient(to top, #6a5a2d, #facc15); height: 70%; }
    .uptime-bar-segment.unknown { background: var(--surface2); border: 1px solid var(--border); height: 100%; opacity: 0.5; }

    .page-footer {
      display: flex; align-items: center; justify-content: space-between;
      margin-top: 48px; padding-top: 24px; border-top: 1px solid var(--border);
      animation: fadeUp 0.6s 0.5s ease both;
    }

    .page-footer p { font-family: var(--mono); font-size: 0.68rem; color: var(--muted); }

    .last-update { font-family: var(--mono); font-size: 0.68rem; color: var(--muted); display: flex; align-items: center; gap: 6px; }
    .update-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--purple); animation: pulse 2s ease infinite; }



    /* Overlay */
    .overlay {
      display: none; position: fixed; inset: 0;
      background: rgba(0,0,0,0.7); backdrop-filter: blur(6px);
      z-index: 200; align-items: center; justify-content: center;
    }
    .overlay.visible { display: flex; }

    /* Modal */
    .modal {
      background: var(--surface); border: 1px solid var(--border);
      border-radius: 20px; padding: 36px; width: 100%; max-width: 420px;
      margin: 24px; position: relative; animation: fadeUp 0.3s ease both;
    }

    .modal h2 { font-size: 1.2rem; font-weight: 700; margin-bottom: 6px; }
    .modal p { font-family: var(--mono); font-size: 0.72rem; color: var(--muted); margin-bottom: 24px; }

    .modal-input {
      width: 100%; background: var(--surface2); border: 1px solid var(--border);
      border-radius: 10px; padding: 12px 16px; color: var(--text);
      font-family: var(--mono); font-size: 0.85rem; margin-bottom: 12px;
      outline: none; transition: border-color 0.2s;
    }
    .modal-input:focus { border-color: var(--purple); }

    .modal-btn {
      width: 100%; padding: 12px; border-radius: 10px; border: none;
      font-family: var(--sans); font-size: 0.9rem; font-weight: 700;
      cursor: pointer; transition: opacity 0.2s; margin-top: 4px;
    }
    .modal-btn.primary { background: var(--purple); color: #fff; }
    .modal-btn.primary:hover { opacity: 0.85; }
    .modal-btn.danger { background: rgba(248,113,113,0.15); color: var(--red); border: 1px solid rgba(248,113,113,0.3); margin-top: 8px; }
    .modal-btn.danger:hover { background: rgba(248,113,113,0.25); }
    .modal-btn.success { background: rgba(251,191,36,0.15); color: var(--yellow); border: 1px solid rgba(251,191,36,0.3); }
    .modal-btn.success:hover { background: rgba(251,191,36,0.25); }

    .modal-close {
      position: absolute; top: 16px; right: 16px;
      background: none; border: none; color: var(--muted);
      font-size: 1.2rem; cursor: pointer; padding: 4px;
    }
    .modal-close:hover { color: var(--text); }

    .modal-error { font-family: var(--mono); font-size: 0.72rem; color: var(--red); margin-top: 8px; display: none; }
    .modal-error.visible { display: block; }

    .admin-status {
      font-family: var(--mono); font-size: 0.72rem; padding: 10px 14px;
      border-radius: 8px; margin-bottom: 16px; text-align: center;
    }
    .admin-status.on { background: rgba(251,191,36,0.1); color: var(--yellow); border: 1px solid rgba(251,191,36,0.2); }
    .admin-status.off { background: rgba(74,222,128,0.1); color: var(--green); border: 1px solid rgba(74,222,128,0.2); }

    .divider { height: 1px; background: var(--border); margin: 20px 0; }

    @keyframes fadeDown { from { opacity: 0; transform: translateY(-16px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes fadeUp { from { opacity: 0; transform: translateY(16px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes pulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.5; transform: scale(1.5); } }
  </style>
</head>
<body>

  <!-- Banni√®re maintenance -->
  <div class="maintenance-banner" id="maintenanceBanner"></div>

  <div class="container" id="mainContainer">
    <header>
      <div class="bot-avatar">ü§ñ</div>
      <div class="header-text">
        <h1>Ayuka</h1>
        <p>// page de statut du bot</p>
      </div>
    </header>

    <div class="global-status" id="globalStatus">
      <div class="status-dot online" id="statusDot"></div>
      <div class="status-label">
        <strong id="statusText">Chargement...</strong>
        <span id="statusSince"></span>
      </div>
      <span class="status-badge online" id="statusBadge">...</span>
    </div>

    <div class="metrics-grid">
      <div class="metric-card">
        <span class="metric-icon">‚ö°</span>
        <div class="metric-label">Latence</div>
        <div class="metric-value" id="latency">‚Äî</div>
        <div class="metric-sub">ms</div>
      </div>
      <div class="metric-card">
        <span class="metric-icon">‚è±Ô∏è</span>
        <div class="metric-label">Uptime</div>
        <div class="metric-value" id="uptime">‚Äî</div>
        <div class="metric-sub">depuis le d√©marrage</div>
      </div>
      <div class="metric-card">
        <span class="metric-icon">üë•</span>
        <div class="metric-label">Membres</div>
        <div class="metric-value" id="members">‚Äî</div>
        <div class="metric-sub">sur le serveur</div>
      </div>
    </div>

    <div class="section-title">‚Äî historique 30 jours</div>
    <div class="uptime-bar" id="uptimeBar"></div>

    <footer class="page-footer">
      <p>Ayuka Bot ¬∑ Priv√©</p>
      <div class="last-update">
        <div class="update-dot"></div>
        <span id="lastUpdate">Chargement...</span>
      </div>
    </footer>
  </div>


  <!-- Modal login -->
  <div class="overlay" id="loginOverlay">
    <div class="modal">
      <button class="modal-close" id="loginClose">‚úï</button>
      <h2>üîê Acc√®s admin</h2>
      <p>Entrez les deux mots de passe pour continuer.</p>
      <input class="modal-input" type="password" id="pass1" placeholder="Mot de passe 1" />
      <input class="modal-input" type="password" id="pass2" placeholder="Mot de passe 2" />
      <div class="modal-error" id="loginError">Mots de passe incorrects.</div>
      <button class="modal-btn primary" id="loginBtn">Connexion</button>
    </div>
  </div>

  <!-- Modal admin panel -->
  <div class="overlay" id="adminOverlay">
    <div class="modal">
      <button class="modal-close" id="adminClose">‚úï</button>
      <h2>‚öôÔ∏è Admin Panel</h2>
      <p>Gestion de la maintenance du bot.</p>

      <div class="admin-status off" id="adminStatusLabel">‚úÖ Aucune maintenance en cours</div>

      <div class="divider"></div>

      <input class="modal-input" type="text" id="maintMessage" placeholder="Message de maintenance..." />
      <input class="modal-input" type="text" id="maintUntil" placeholder="Pr√©vue jusqu'√†... (ex: 20h30)" />
      <button class="modal-btn success" id="startMaintBtn">üü° Activer la maintenance</button>
      <button class="modal-btn danger" id="stopMaintBtn">üî¥ Arr√™ter la maintenance</button>
    </div>
  </div>

  <script>
    // =============================================
    // CONFIGURATION ‚Äî √Ä modifier
    // =============================================
    const JSONBIN_BIN_ID = '69974765ae596e708f37ddc1';
    const JSONBIN_API_KEY = '$2a$10$ebbbCoxcHHC8exubvUxbw.dmYeXD.jAeoBDL3BJNwiGYJmr3vbcNm';
    const API_URL = `https://api.jsonbin.io/v3/b/${JSONBIN_BIN_ID}/latest`;
    const API_PUT = `https://api.jsonbin.io/v3/b/${JSONBIN_BIN_ID}`;

    // Les deux mots de passe admin ‚Äî change-les !
    const ADMIN_PASS_1 = 'motdepasse1';
    const ADMIN_PASS_2 = 'motdepasse2';
    // =============================================

    let cachedData = null;

    function formatUptime(seconds) {
      const d = Math.floor(seconds / 86400);
      const h = Math.floor((seconds % 86400) / 3600);
      const m = Math.floor((seconds % 3600) / 60);
      if (d > 0) return `${d}j ${h}h`;
      if (h > 0) return `${h}h ${m}m`;
      return `${m}m`;
    }

    function formatSince(timestamp) {
      const diff = Math.floor((Date.now() - timestamp) / 1000);
      if (diff < 60) return `depuis ${diff}s`;
      if (diff < 3600) return `depuis ${Math.floor(diff/60)}min`;
      if (diff < 86400) return `depuis ${Math.floor(diff/3600)}h`;
      return `depuis ${Math.floor(diff/86400)}j`;
    }

function generateUptimeBar(history) {
  const bar = document.getElementById('uptimeBar');
  bar.innerHTML = '';

  if (!history || history.length === 0) {
    for (let i = 0; i < 30; i++) {
      const seg = document.createElement('div');
      seg.className = 'uptime-bar-segment unknown';
      seg.title = 'Aucune donn√©e';
      bar.appendChild(seg);
    }
    return;
  }

  const last30 = history.slice(-30);

  last30.forEach(day => {
    const seg = document.createElement('div');
    seg.classList.add('uptime-bar-segment');

    const pct = day.percentage || 0;

    if (pct >= 95) {
      seg.classList.add('up');
      seg.title = `${day.date} ‚Üí ${pct}% (Op√©rationnel)`;
    } else if (pct >= 80) {
      seg.classList.add('partial');
      seg.title = `${day.date} ‚Üí ${pct}% (Partial outage)`;
    } else {
      seg.classList.add('down');
      seg.title = `${day.date} ‚Üí ${pct}% (Major outage)`;
    }

    bar.appendChild(seg);
  });

  // compl√©ter √† 30 segments si besoin
  const missing = 30 - last30.length;
  for (let i = 0; i < missing; i++) {
    const seg = document.createElement('div');
    seg.className = 'uptime-bar-segment unknown';
    seg.title = 'Aucune donn√©e';
    bar.prepend(seg);
  }
}

    function updateCounters() {
      if (!cachedData || !cachedData.online) return;
      const uptimeSeconds = Math.floor((Date.now() - cachedData.since) / 1000);
      document.getElementById('uptime').textContent = formatUptime(uptimeSeconds);
      document.getElementById('statusSince').textContent = formatSince(cachedData.since);
    }

    function applyData(data) {
      cachedData = data;
      const isMaintenance = data.maintenance === true;
      const isOnline = data.online && !isMaintenance;

      const dot = document.getElementById('statusDot');
      const badge = document.getElementById('statusBadge');
      const text = document.getElementById('statusText');
      const globalStatus = document.getElementById('globalStatus');
      const banner = document.getElementById('maintenanceBanner');
      const container = document.getElementById('mainContainer');

      // Maintenance
      if (isMaintenance) {
        dot.className = 'status-dot maintenance';
        badge.className = 'status-badge maintenance';
        badge.textContent = 'Maintenance';
        text.textContent = 'Maintenance en cours';
        globalStatus.className = 'global-status maintenance';
        const msg = data.maintenance_message || 'Maintenance en cours.';
        const until = data.maintenance_until ? ` ‚Äî Pr√©vue jusqu\'√† ${data.maintenance_until}` : '';
        banner.textContent = `üîß ${msg}${until}`;
        banner.classList.add('visible');
        container.classList.add('with-banner');
        document.getElementById('statusSince').textContent = '';
      } else {
        globalStatus.className = 'global-status';
        banner.classList.remove('visible');
        container.classList.remove('with-banner');
        dot.className = 'status-dot ' + (isOnline ? 'online' : 'offline');
        badge.className = 'status-badge ' + (isOnline ? 'online' : 'offline');
        badge.textContent = isOnline ? 'En ligne' : 'Hors ligne';
        text.textContent = isOnline ? 'Tous les syst√®mes op√©rationnels' : 'Bot hors ligne';
      }

      document.getElementById('latency').textContent = data.online ? data.latency : '‚Äî';
      document.getElementById('members').textContent = data.members ? data.members.toLocaleString('fr-FR') : '‚Äî';

      if (!data.online) {
        document.getElementById('uptime').textContent = '‚Äî';
        document.getElementById('statusSince').textContent = '';
      }

      const now = new Date();
      document.getElementById('lastUpdate').textContent =
        `Mis √† jour √† ${now.getHours().toString().padStart(2,'0')}:${now.getMinutes().toString().padStart(2,'0')}:${now.getSeconds().toString().padStart(2,'0')}`;

      // Mettre √† jour le panneau admin si ouvert
      generateUptimeBar(data.history);
      updateAdminPanel(data);
    }

    async function fetchStatus() {
      try {
        const res = await fetch(API_URL, {
          headers: { 'X-Master-Key': JSONBIN_API_KEY }
        });
        if (!res.ok) throw new Error();
        const json = await res.json();
        applyData(json.record);
      } catch (e) {
        document.getElementById('statusText').textContent = 'Impossible de charger le statut';
        document.getElementById('lastUpdate').textContent = 'Erreur de connexion';
        document.getElementById('statusDot').className = 'status-dot unknown';
        document.getElementById('statusBadge').className = 'status-badge unknown';
        document.getElementById('statusBadge').textContent = 'Inconnu';
      }
    }

    async function pushData(patch) {
      const data = { ...cachedData, ...patch };
      await fetch(API_PUT, {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
          'X-Master-Key': JSONBIN_API_KEY
        },
        body: JSON.stringify(data)
      });
      // Vider le cache et re-fetch les vraies donn√©es
      const res = await fetch(API_URL, {
        cache: 'no-store',
        headers: { 'X-Master-Key': JSONBIN_API_KEY }
      });
      const json = await res.json();
      cachedData = json.record;
      applyData(json.record);
    }

    // =============================================
    // ADMIN PANEL
    // =============================================

    function updateAdminPanel(data) {
      const label = document.getElementById('adminStatusLabel');
      if (!label) return;
      if (data.maintenance) {
        label.className = 'admin-status on';
        label.textContent = `üü° Maintenance active ‚Äî ${data.maintenance_message || ''} ${data.maintenance_until ? 'jusqu\'√† ' + data.maintenance_until : ''}`;
      } else {
        label.className = 'admin-status off';
        label.textContent = '‚úÖ Aucune maintenance en cours';
      }
    }

    // Raccourci secret : Shift + A + Y simultan√©ment
    const keysHeld = new Set();
    document.addEventListener('keydown', (e) => {
      keysHeld.add(e.key);
      if (keysHeld.has('A') && keysHeld.has('Y') && keysHeld.has('Shift')) {
        document.getElementById('loginOverlay').classList.add('visible');
        document.getElementById('pass1').value = '';
        document.getElementById('pass2').value = '';
        document.getElementById('loginError').classList.remove('visible');
      }
    });
    document.addEventListener('keyup', (e) => { keysHeld.delete(e.key); });

    document.getElementById('loginClose').addEventListener('click', () => {
      document.getElementById('loginOverlay').classList.remove('visible');
    });

    document.getElementById('loginBtn').addEventListener('click', () => {
      const p1 = document.getElementById('pass1').value;
      const p2 = document.getElementById('pass2').value;
      if (p1 === ADMIN_PASS_1 && p2 === ADMIN_PASS_2) {
        document.getElementById('loginOverlay').classList.remove('visible');
        document.getElementById('adminOverlay').classList.add('visible');
        if (cachedData) updateAdminPanel(cachedData);
      } else {
        document.getElementById('loginError').classList.add('visible');
      }
    });

    // Fermer le panel admin
    document.getElementById('adminClose').addEventListener('click', () => {
      document.getElementById('adminOverlay').classList.remove('visible');
    });

    // Activer maintenance
    document.getElementById('startMaintBtn').addEventListener('click', async () => {
      const msg = document.getElementById('maintMessage').value.trim() || 'Maintenance en cours.';
      const until = document.getElementById('maintUntil').value.trim();
      await pushData({ maintenance: true, maintenance_message: msg, maintenance_until: until });
    });

    // Arr√™ter maintenance
    document.getElementById('stopMaintBtn').addEventListener('click', async () => {
      await pushData({ maintenance: false, maintenance_message: '', maintenance_until: '' });
    });

    // Enter pour login
    document.getElementById('pass2').addEventListener('keydown', (e) => {
      if (e.key === 'Enter') document.getElementById('loginBtn').click();
    });

    // =============================================
    fetchStatus();
    setInterval(fetchStatus, 300000);
    setInterval(updateCounters, 1000);
  </script>
</body>
</html>
